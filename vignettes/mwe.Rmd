---
title: "A minimal example"
author: "Gao Wang and Shengtong Han"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{minimal example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE,comment = "#",fig.width = 4.5,
                      fig.height = 3,fig.align = "center",
                      fig.cap = "&nbsp;",dpi = 120)
```


## Input data 


Here is a minimal example for `mirage`. First load  two test toy data-sets, `mirage_vs_toy` is for variant set (VS) with variant level only and `mirage_toy` is for gene set with both variant level and gene level.  

```{r}
library(mirage)
data(mirage_toy)
head(mirage_toy)
data(mirage_vs_toy)
head(mirage_vs_toy)
```
In both `mirage_vs_toy` and `mirage_toy`, every row is a variant with its summary statistics (number of variants in cases `No.case` and number of variants in control `No.contr`), variant group index `group.index` (which variant group it is from) and gene `Gene` (if any, which gene it is in) in columns. Variant groups can be user defined, usually depending on its annotations.  


## Output 

Apply `mirage_vs` and `mirage` to toy data. 

```{r}
res_vs = mirage_vs(mirage_vs_toy,n1=1000,n2=1000)
str(res_vs)
res_vs$eta.est
res_vs$eta.pvalue
head(res_vs$full.info)
```

`n1, n2` are sample sizes in cases and controls. Other key parameters are set by default $\gamma=3, \sigma=2, \eta_0=0.1$ and it is up to users to choose whatever you want, but $\eta$ initial must be positive number within $(0,1)$.  



















## Session information

Here are some details about the computing environment, including the
versions of R, and the R packages, used to generate these results.

```{r}
sessionInfo()
```
